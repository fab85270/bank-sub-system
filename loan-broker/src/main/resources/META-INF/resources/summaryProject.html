<!DOCTYPE html>
    <head>
        <script>
            function fonc(idProject){

                /* On effectue une requête POST pour envoyer l'id du project séléctionné */

                let xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
                xmlhttp.open("POST", "/broker/sendProject");
                xmlhttp.setRequestHeader("Content-Type", "application/json");
                xmlhttp.send(idProject);
            }
            async function myFonction() {
                const response = await fetch("/broker/getProject", {
                    method: 'GET', // *GET, POST, PUT, DELETE, etc.
                    mode: 'cors', // no-cors, *cors, same-origin
                    cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                    credentials: 'same-origin', // include, *same-origin, omit
                    headers: {
                        'Content-Type': 'application/json'
                        // 'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    redirect: 'follow', // manual, *follow, error
                    referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url// body data type must match "Content-Type" header
                }).then(res => res.json());
                console.log(response);


                /* On va clear le document au début */
                document.getElementById('p1').innerHTML = "";

                for (const object in response) {
                    /* On remplit le document pour affichage*/
                    console.log(object);
                    document.getElementById('p1').innerHTML +=
                        '<td> <br>Project numéro '+ object +' : <br>'+ '<br>Description : ' + response[object].projectDescription +'<br> Somme voulue : '+response[object].demandedValue  + ' euros<br>' + 'Date début souhaitée : '+ response[object].estimatedStartDate+ '<br> Date de fin souhaitée : '+ response[object].estimatedDeadline+ '<br> Projet délivré : '+response[object].delivered+'<br>' +
                        '<button class="favorite styled" type="button" onclick()="unload(fonc)">Envoyer ce projet</button><br></td>';
                }
            }
        </script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="shortcut icon" href="#" />
    <style>
            body{
                background-color: antiquewhite;
            }
            .contenair{

            }
            .formulaire{
                margin: auto;
                width: 50%;
            }
            .presentation{
                padding-bottom: 40px;
            }
            .presentation h1,h3{
                text-align: center;
            }
            .form-check{
                text-align: center;
            }
        </style>
    </head>
    <body>
        <h1>Recapitulatif du projet Client</h1>
        <div>
            <p>
                Affichage du projet pour savoir si le broker valide ou pas
                Si valider le projet est envoyé à la banque avec un projetDTO
                La banque fait ses affaires et renvoie un loanProposal avec le loanProposalDTO
            </p>
        </div>
        <div class="form-check">
            <input type="button" class="form-check-input" id="boutton" value="Afficher toutes les propositions de project" onclick="myFonction()">
        </div>
        <table>
            <td id ='p1'>

            </td>
        </table>

    </body>
</html>